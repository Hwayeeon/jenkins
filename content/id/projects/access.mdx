---
title: "@chronark/access"
description: Pustaka minimal untuk kontrol akses. Dirancang untuk digunakan bersama dengan token akses opaque dengan menyediakan antarmuka sederhana untuk mendefinisikan peran dengan izin akses berbeda dan memverifikasi permintaan ke sumber daya.
repository: chronark/access
date: "2022-11-13"
published: true
  
---
Pustaka minimal untuk kontrol akses. Dirancang untuk digunakan bersama dengan token akses opaque dengan menyediakan antarmuka sederhana untuk mendefinisikan peran dengan izin akses berbeda dan memverifikasi permintaan ke sumber daya.

- Sepenuhnya bertipe
- Tanpa dependensi
- Dapat diserialisasi untuk disimpan di database

## Instalasi

```sh-session
npm i @chronark/access
```

## Penggunaan

```ts
import { AccessControl, Role } from "@chronark/access";

/**
 * Definisikan semua sumber daya dan pola aksesnya
 *
 * key => sumber daya
 * value => array tipe akses
 */
type Statements = {
  user: ["read", "write", "dance"];
  team: ["read", "write"];
};

/**
 * Buat instance kontrol akses dan masukkan tipe Statements untuk menikmati
 * keamanan tipe penuh
 */
const ac = new AccessControl<Statements>();

/**
 * Sekarang Anda dapat mendefinisikan satu atau lebih peran dengan menentukan
 * izin akses
 *
 * Ini sudah sepenuhnya bertipe dan typescript akan memberitahu Anda jika Anda
 * mencoba menggunakan apa pun yang tidak didefinisikan dalam tipe Statements.
 */
const role = ac.newRole({
  user: ["read", "write"],
  team: ["read"],
});

/**
 * Simulasikan penyimpanan dan pengambilan peran di database
 *
 * Idenya di sini adalah Anda dapat menyimpan izin bersama dengan token API.
 * Sekarang, ketika Anda memverifikasi token, Anda juga dapat memverifikasi izin akses.
 */
const serialized = role.toString();

/**
 * Perhatikan bagaimana Anda dapat memasukkan tipe Statements lagi, untuk mendapatkan
 * keamanan tipe penuh
 */
const recovered = Role.fromString<Statements>(serialized);

/**
 * Validasi peran dengan menentukan sumber daya dan akses yang diperlukan
 *
 * semuanya sepenuhnya bertipe
 */
const res = recovered.authorize({"team", ["read"]});

// res.success => boolean
// res.error => string | undefined memberikan alasan kegagalan
```
