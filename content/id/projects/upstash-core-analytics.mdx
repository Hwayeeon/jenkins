---
title: Upstash Core Analytics
description: Utilitas low level untuk membangun alat analitik di atas Redis.
date: "2023-02-13"
url: https://console.upstash.com/ratelimit
repository: upstash/core-analytics
published: true

---


Pustaka ini menawarkan beberapa building block low level untuk merekam dan menganalisis event kustom di Redis.
Tujuan utamanya adalah menyediakan cara sederhana untuk merekam dan query event di Redis tanpa harus khawatir tentang struktur data yang mendasarinya sehingga kita dapat membangun fitur analitik yang lebih canggih di atasnya.

## Quickstart


1. Buat database redis

Pergi ke [console.upstash.com/redis](https://console.upstash.com/redis) dan buat
database global baru.

Setelah membuat db, salin `UPSTASH_REDIS_REST_URL` dan `UPSTASH_REDIS_REST_TOKEN` ke file `.env` Anda.

3. Instal `@upstash/analytics` di proyek Anda

```bash
npm install @upstash/analytics @upstash/redis
```

4. Buat klien analytics

```ts
import { Analytyics } from "@upstash/analytics";
import { Redis } from "@upstash/redis";

const analytics = new Analytics({
  redis: Redis.fromEnv(),
  window: "1d",
});
```


5. Masukkan beberapa event

Sebuah event terdiri dari field `time` dan pasangan key-value tambahan yang dapat Anda gunakan untuk merekam informasi apa pun yang Anda inginkan.

```ts
const event = {
  time: Date.now() // opsional (default: Date.now())
  userId: "chronark",
  page: "/auth/login",
  country: "DE",
}

await analytics.ingest("pageviews", event);
```

4. Query event Anda

```ts

const result = await analytics.query("pageviews");

```

## Development

Proyek ini menggunakan `pnpm` untuk manajemen dependensi.

#### Instal dependensi

```bash
pnpm install
```

#### Build

```bash
pnpm build
```


## Skema Database

Semua metrik disimpan dalam tipe data Redis `Hash` dan di-shard ke dalam bucket berdasarkan opsi `window`.
```
@upstash/analytics:{TABLE}:{TIMESTAMP}
```
- `TABLE` adalah namespace untuk mengelompokkan event bersama. misalnya untuk mengelola beberapa proyek dalam satu database
- `TIMESTAMP` adalah timestamp awal dari setiap window

Field dari setiap hash adalah objek JSON yang diserialisasi dengan data event pengguna dan nilainya adalah berapa kali event ini telah direkam.

```json
{
  '{"page": "/auth/login","country": "DE"}': 5,
  '{"page": "/auth/login","country": "US"}': 2
}
```
